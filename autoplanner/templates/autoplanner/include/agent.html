{% load i18n djangofloor bootstrap3 autoplanner %}
<tr id="row_agent_{{ obj.id }}"><form role="form" {% if obj.id is None %}onsubmit="$('#check_agent_{{ obj.id }}').attr('class', 'fa fa-spin fa-spinner'); return $.df.call('autoplanner.forms.add_agent', {organization_pk: {{ organization.id }}, value: $(this).serializeArray()})"{% endif %}>
    <td style="width: 20px;">
        <i class="fa" id="check_agent_{{ obj.id }}"></i>
    </td>
    <td>
        <input type="text" class="form-control" id="id_name_{{ obj.id }}" name="name"
               {% if obj.id %}onchange="$('#check_agent_{{ obj.id }}').attr('class', 'fa fa-spin fa-spinner'); return $.df.call('autoplanner.forms.set_agent_name', {organization_pk: {{ organization.id }}, agent_pk: {{ obj.id }}, value: $(this).serializeArray()})"{% endif %}
               value="{{ obj.name }}">

    </td>
    <td>
        <input type="datetime-local" class="form-control" id="id_start_time_{{ obj.id }}" name="start_time"
               {% if obj.id %}onchange="$('#check_agent_{{ obj.id }}').attr('class', 'fa fa-spin fa-spinner'); return $.df.call('autoplanner.forms.set_agent_start_time', {organization_pk: {{ organization.id }}, agent_pk: {{ obj.id }}, value: $(this).serializeArray()})"{% endif %}
               value="{% if obj.start_time %}{{ obj.start_time }}{% endif %}">
    </td>
    <td>
        <input type="datetime-local" class="form-control" id="id_end_time_{{ obj.id }}" name="end_time"
               {% if obj.id %}onchange="$('#check_agent_{{ obj.id }}').attr('class', 'fa fa-spin fa-spinner'); return $.df.call('autoplanner.forms.set_agent_end_time', {organization_pk: {{ organization.id }}, agent_pk: {{ obj.id }}, value: $(this).serializeArray()})"{% endif %}
               value="{% if obj.end_time %}{{ obj.end_time }}{% endif %}">
    </td>
    <td>{% if obj.id %}
    <button class="btn btn-sm btn-info"
            onclick="$('#check_agent_{{ obj.id }}').attr('class', 'fa fa-spin fa-spinner'); return $.df.call('autoplanner.forms.show_agent_infos', {organization_pk: {{ organization.id }}, agent_pk: {{ obj.id }} })">
        <i class="fa fa-plus-circle"></i>
    </button>{% else %}&nbsp;{%endif %}
    </td>
    <td>
        {% if obj.id %}<button class="btn btn-sm btn-danger" onclick="$('#check_agent_{{ obj.id }}').attr('class', 'fa fa-spin fa-spinner'); return $.df.call('autoplanner.forms.remove_agent', {organization_pk: {{ organization.id }}, agent_pk: {{ obj.id }} })"><i class="fa fa-minus"></i></button>
        {% else %}<button class="btn btn-sm btn-success"
                          onclick="$('#check_agent_{{ obj.id }}').attr('class', 'fa fa-spin fa-spinner'); return $.df.call('autoplanner.forms.add_agent', {organization_pk: {{ organization.id }}, value: $('#row_agent_{{ obj.id }} form').serializeArray()})">
        <i class="fa fa-plus"></i></button>
        {% endif %}
    </td>
</form>
</tr>
